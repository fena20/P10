benchmarks:
  enabled: true
  metrics_for_plots:
  - weighted_rmse
  - weighted_mae
  models:
  - lightgbm_monolithic
  - ebm
  - xgboost
  - catboost
  save_plots: true
data:
  area_column: TOTSQFT_EN
  n_replicate_weights: 60
  processed_path: data/processed/
  raw_path: data/raw/recs2020_public_v7.csv
  replicate_weights_prefix: NWEIGHT
  target_column: TOTALBTUSPH
  targets:
    per_area: E_heat_per_area
    primary: TOTALBTUSPH
  weight_column: NWEIGHT
evaluation:
  metrics:
  - weighted_rmse
  - weighted_mae
  - weighted_r2
  - weighted_mape
  physics_checks:
    hdd_residual_bins:
    - 0
    - 1000
    - 2000
    - 3000
    - 4000
    - 5000
    - 6000
    - 8000
    - 100000
    hdd_sensitivity_direction: positive
    negative_prediction_threshold: 0.0
  policy:
    scores:
    - high_use
    - high_intensity
    - excess_demand
    target_percentile: 90
external_validation:
  enabled: false
  utility_bills_path: ''
feature_builder:
  covid_control_mode: proxy
  encode_categorical: onehot
  include_interactions: false
  scale_continuous: false
features:
  auxiliary:
  - USEEQUIPAUX
  - BASEHEAT
  - ATTCHEAT
  - GARGHEAT
  building:
  - TYPEHUQ
  - YEARMADERANGE
  - STORIES
  - TOTSQFT_EN
  - TOTHSQFT
  - TOTCSQFT
  - BEDROOMS
  - TOTROOMS
  - CELLR
  - CRAWL
  - CONCRETE
  - ATTIC
  - ATTICFIN
  - WALLTYPE
  - ROOFTYPE
  - WINDOWS
  - TYPEGLASS
  - WINFRAME
  - ADQINSUL
  - DRAFTY
  climate:
  - HDD65
  - CDD65
  - HDD30YR_PUB
  - DIVISION
  - BA_climate
  - IECC_climate_code
  covid_controls:
  - TELLWORK
  - ATHOME
  equipment:
  - EQUIPM
  - FUELHEAT
  - EQUIPAGE
  - EQUIPAUX
  - FUELAUX
  - HEATCNTL
  - TEMPHOME
  leakage_blacklist:
  - DOLLAREL
  - DOLLARNG
  - DOLLARLP
  - DOLLARFO
  - TOTALDOL
  - TOTALDOLSPH
  - DOLELSPH
  - DOLNGSPH
  - DOLLPSPH
  - DOLFOSPH
  occupancy:
  - NHSLDMEM
  - NUMCHILD
  - NUMADULT1
  - NUMADULT2
  - HHAGE
  - EMPLOYHH
  - ATHOME
hardware:
  device: auto
  gpu_id: 0
  lgbm_gpu_platform_id: 0
models:
  catboost:
    n_search_iter: 10
    search_space:
      depth:
      - 6
      - 8
      - 10
      iterations:
      - 2000
      - 4000
      l2_leaf_reg:
      - 1.0
      - 3.0
      - 5.0
      learning_rate:
      - 0.03
      - 0.05
      - 0.1
  ebm:
    base_params:
      early_stopping_rounds: 50
      inner_bags: 0
      interactions: 10
      learning_rate: 0.01
      max_bins: 256
      outer_bags: 8
      random_state: 42
      validation_size: 0.15
    search_space:
      max_leaves:
      - 3
      - 4
      - 5
      max_rounds:
      - 5000
      - 10000
      - 15000
      min_samples_leaf:
      - 2
      - 5
      - 10
  lightgbm:
    base_params:
      boosting_type: gbdt
      metric: rmse
      objective: gamma
      random_state: 42
      verbose: -1
    debiasing:
      cold_hdd_quantile: 0.85
      cold_multiplier: 1.25
      enabled: false
      focal_gamma: 2.0
      tail_multiplier: 1.5
      tail_quantile: 0.95
      two_pass_focal: false
    monotone_constraints:
      ADQINSUL: -1
      HDD65: 1
    n_search_iter: 12
    search_space:
      colsample_bytree:
      - 0.7
      - 0.8
      - 0.9
      - 1.0
      learning_rate:
      - 0.03
      - 0.05
      - 0.1
      max_depth:
      - 6
      - 8
      - -1
      min_child_samples:
      - 20
      - 50
      - 100
      n_estimators:
      - 200
      - 400
      - 800
      num_leaves:
      - 31
      - 63
      - 127
      reg_alpha:
      - 0
      - 0.1
      reg_lambda:
      - 0.1
      - 1.0
      subsample:
      - 0.7
      - 0.8
      - 0.9
      - 1.0
  tabular_transformer:
    n_search_iter: 8
    search_space:
      batch_size:
      - 256
      - 512
      d_model:
      - 64
      - 128
      dropout:
      - 0.05
      - 0.1
      epochs:
      - 20
      - 40
      lr:
      - 0.001
      - 0.0005
      n_heads:
      - 4
      - 8
      n_layers:
      - 2
      - 3
  xgboost:
    n_search_iter: 10
    search_space:
      colsample_bytree:
      - 0.7
      - 0.85
      - 1.0
      learning_rate:
      - 0.03
      - 0.05
      - 0.1
      max_depth:
      - 4
      - 6
      - 8
      n_estimators:
      - 600
      - 1000
      - 1400
      reg_alpha:
      - 0.0
      - 0.1
      - 0.5
      reg_lambda:
      - 0.5
      - 1.0
      - 2.0
      subsample:
      - 0.7
      - 0.85
      - 1.0
nested_cv:
  hdd_bin_labels:
  - very_mild
  - mild
  - moderate
  - cold
  - very_cold
  hdd_bins:
  - 0
  - 2000
  - 4000
  - 6000
  - 8000
  - 100000
  inner_folds: 3
  outer_folds: 5
  random_state: 42
  stratify_by:
  - DIVISION
  - tech_group
  - HDD_bin
output:
  figure_dpi: 300
  figure_format: png
  figures_dir: outputs/figures/
  models_dir: outputs/models/
  tables_dir: outputs/tables/
runtime:
  gpu_id: 0
  lgbm_gpu_platform_id: 0
  use_cuda: false
sensitivity:
  analyses:
  - description: Compare E vs E/Area targets
    name: target_comparison
    variations:
    - target: TOTALBTUSPH
    - target: E_heat_per_area
  - description: Exclude HDD < 1000
    name: climate_restriction
    variations:
    - hdd_min: 0
    - hdd_min: 1000
  - description: Direct vs proxy vs none
    name: covid_controls
    variations:
    - covid: direct
    - covid: proxy
    - covid: none
  - description: Technology grouping rules
    name: tech_assignment
    variations:
    - rule: primary_only
    - rule: with_hybrid
    - rule: exclude_hybrid
  - description: With vs without constraints
    name: monotonic_constraints
    variations:
    - constraints: true
    - constraints: false
technology_groups:
  combustion:
    description: Combustion-based heating systems
    equipm_codes:
    - 2
    - 3
    - 7
    - 8
    fuelheat_codes:
    - 1
    - 2
    - 3
    - 7
  electric_heat_pump:
    description: Electric heat pump systems
    equipm_codes:
    - 4
    fuelheat_codes:
    - 5
  electric_resistance:
    description: Electric resistance heating
    equipm_codes:
    - 5
    - 10
    fuelheat_codes:
    - 5
  excluded:
    description: No heating system
    equipm_codes:
    - -2
  hybrid_ambiguous:
    description: Hybrid or ambiguous systems
    equipm_codes:
    - 13
    - 99
uncertainty:
  jackknife:
    confidence_level: 0.95
    n_replicates: 60
  refit_sensitivity:
    n_refit_replicates: 10
    refit_indices:
    - 1
    - 7
    - 13
    - 19
    - 25
    - 31
    - 37
    - 43
    - 49
    - 55
